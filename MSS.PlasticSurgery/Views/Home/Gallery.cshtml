@{
    Layout = "_PageLayout";
    ViewData["Title"] = "Галерея";
}

@model GalleryViewModel

@section Styles {
    <link type="text/css" rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css">
    <link type="text/css" rel="stylesheet" href="~/lib/jquery-lightgallery/css/lightgallery.min.css">
    <link type="text/css" rel="stylesheet" href="~/css/home/gallery.css">
}

<div class="inner-container">
    <ul id="operations-accordion" class="unordered-list accordion">
        @{
            var index = 0;
        }

        @foreach (var operationTitle in Model.OperationTypeTitles)
        {
            <li>
                <button class="btn btn-block btn-outline-success no-accent operation-type"
                        data-toggle="collapse"
                        data-target="#light-gallery-@index"
                        role="button"
                        aria-expanded="false"
                        aria-controls="light-gallery-@index">
                    @operationTitle
                </button>
                <div id="light-gallery-@index"
                     class="collapse light-gallery"
                     data-parent="#operations-accordion">
                    @foreach (var item in Model.ImagesAndThumbnails)
                    {
                        <a href="@Url.Content(item.Key)">
                            <img class="gallery-thumbnail" src="@Url.Content(item.Value)"/>
                        </a>
                    }
                </div>
            </li>

            index++;
        }
    </ul>
</div>

@section Scripts {
    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="~/lib/jquery-lightgallery/js/lightgallery.min.js"></script>
    <script src="~/lib/jquery-lightgallery/js/lg-fullscreen.min.js"></script>
    <script src="~/lib/jquery-lightgallery/js/lg-thumbnail.min.js"></script>
    <script src="~/lib/jquery-lightgallery/js/lg-hash.min.js"></script>

    <script type="text/javascript">
        (function ($) {
            'use strict';

            $(document).ready(function () {
                var galleriesCount = @Model.OperationTypeTitles.Length;

                for (var i = 0; i < galleriesCount; i++) {
                    var $lightGallery = $('#light-gallery-' + i).lightGallery({
                        galleryId: i,
                        download: false
                    });

                    $lightGallery.on('onBeforeOpen.lg', function (event) {
                        $('.page-wrapper.loaded .close-btn', parent.document).hide();
                    });

                    $lightGallery.on('onBeforeClose.lg', function (event) {
                        $('.page-wrapper.loaded .close-btn', parent.document).show('slow');
                    });
                }
            });
        })(jQuery);
    </script>
}